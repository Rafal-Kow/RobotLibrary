&ACCESS  R
&COMMENT KS_1.2
&PARAM DISKPATH = VW_User/Applikation/Vision/HGV
&PARAM TPVW_VERSION = 8.3.8
&REL 18
DEFDAT  vw_hgv_usr_r PUBLIC
; 
;*---------------------------------------------*
;* HGV GmbH&Co.KG                              *
;*                                             *
;* Bearbeitet am:                              *
;* 29.09.2011 PH                               *
;*     Erstellt                                *
;*---------------------------------------------*
; 
;FOLD IN-Signals
;Kommando Byte0, Byte1
;Dateninfo Fehler Byte2,Byte3
;SIGNAL I_HGV_FehlNr $IN[1969]  TO $IN[1984]
SIGNAL I_HGV_Life $IN[1985] ; 1.7 Life-Bit
SIGNAL HGV_CommandIn $IN[1953]  TO $IN[1960]
SIGNAL HGV_AckIn $IN[1961]  TO $IN[1968]
SIGNAL HGV_IDIn $IN[1969]  TO $IN[2000]
SIGNAL HGV_ModeIn $IN[2001]  TO $IN[2016]
SIGNAL HGV_StatusIn $IN[1969]  TO $IN[1984]
SIGNAL HGV_Double1In $IN[2017]  TO $IN[2048]
SIGNAL HGV_Double2In $IN[2049]  TO $IN[2080]
SIGNAL HGV_Double3In $IN[2081]  TO $IN[2112]
SIGNAL HGV_UPIn $IN[2001]  TO $IN[2016] ; 
;ENDFOLD (IN-Signals)
; 
;FOLD OUT-Signals
;Kommando Byte0, Byte1
;Achtung in der vw_usr_s.dat weitere Signale definiert
;SIGNAL O_HGV_Cmd $OUT[1953]  TO $OUT[1960] ;KOMMANDOBYTE1
SIGNAL O_HGV_Life $OUT[1961] ; 1.7 Life-Bit
SIGNAL HGV_CommandOut $OUT[1953]  TO $OUT[1960]
SIGNAL HGV_SequenceOut $OUT[1961]  TO $OUT[1968]
SIGNAL HGV_IDOut $OUT[1969]  TO $OUT[2000]
SIGNAL HGV_ModeOut $OUT[2001]  TO $OUT[2016]
SIGNAL HGV_Double1Out $OUT[2017]  TO $OUT[2048]
SIGNAL HGV_Double2Out $OUT[2049]  TO $OUT[2080]
SIGNAL HGV_Double3Out $OUT[2081]  TO $OUT[2112]
;ENDFOLD (OUT-Signals)
; 
;FOLD Variablen
ENUM HGV_MsgType StatMsg,QuitMsg,NotifyMsg,WaitMsg,DlgMsg
DECL HGV_MsgType HGV_MLD_TYP=#NotifyMsg
GLOBAL BOOL B_HGV_Debug=FALSE
GLOBAL BOOL B_HGV_StopAtPointError=FALSE
BOOL B_HGV_Check_Art=FALSE
BOOL B_HGV_Check_TCP=FALSE
BOOL B_HGV_TCalib=FALSE
INT N_HGV_RobMv=1022
INT N_HGV_Err1,N_HGV_Err2,N_HGV_MsgOff,N_HGV_Fkt,N_HGV_Ret1
BOOL B_HGV_MsgFlg,B_HGV_RetVal
DECL INT nDlgHandlePoint=11146
DECL INT nDlgHandleUP=0
; 
GLOBAL INT HGV_Command,HGV_ID,HGV_Mode
GLOBAL E6POS HGV_PointToCorrect
GLOBAL E6POS HGV_CorrectedPoint
GLOBAL E6AXIS HGV_AxisToCorrect
GLOBAL E6AXIS HGV_AxisCorrection
GLOBAL INT HGV_Status
GLOBAL FRAME HGV_FrameIn={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
GLOBAL E6POS HGV_NullPos={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0,S 0,T 0,E1 0.0,E2 0.0,E3 0.0,E4 0.0,E5 0.0,E6 0.0}
GLOBAL E6AXIS HGV_NullAxis={A1 0.0,A2 0.0,A3 0.0,A4 0.0,A5 0.0,A6 0.0,E1 0.0,E2 0.0,E3 0.0,E4 0.0,E5 0.0,E6 0.0}
GLOBAL FRAME HGV_NullFrame={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
GLOBAL INT HGV_CommTimeout=4000
GLOBAL INT HGV_ReadFrameTimeout=8000
GLOBAL INT HGV_CalculateTimeout=20000
GLOBAL INT HGV_ErrorStatus
GLOBAL REAL HGV_InPosWaitTime=0.500000
BOOL HGV_CalculationRequired=FALSE
INT HGV_Handle=0
GLOBAL BOOL B_HGV_FrameRead=TRUE
CHAR HGV_strErrorSource[5]
BOOL HGV_Communicate
INT START_HGV=1
INT END_HGV=2
INT TRIGGER_HGV=3
INT READ_FRAME_HGV=4
INT REQUEST_PHYS_COMP_HGV=5
INT READ_PHYS_COMP_HGV=6
INT REQUEST_UP_HGV=7
INT TRIGGER_HGV2=13
INT READ_FRAME_HGV2=14
INT F_507=507
;ENDFOLD (Variablen)
; 
;FOLD Fehler-Flags
GLOBAL INT N_HGV_FiErr=495 ; Erstes Fehler Flag
GLOBAL INT N_HGV_LgErr=10 ; L?nge der Flags
GLOBAL INT F_HGV_TmOut=505 ; TimeOut
GLOBAL INT F_HGV_NoVal=504 ; Kein Auftrag
GLOBAL INT F_HGV_SyIna=503 ; System Inaktiv
GLOBAL INT F_HGV_SyAkt=498 ; System Aktiv
GLOBAL INT F_HGV_NoStr=502 ; Kein Messstart von SPS
GLOBAL INT F_HGV_ModID=501 ; Falsche Modell ID
GLOBAL INT F_HGV_VFMax=500 ; Maximale Korrekturwerte erreicht
GLOBAL INT F_HGV_VFErr=499 ; Korrekturwerte nicht vorhanden
GLOBAL INT F_HGV_NoErr=495 ; Kein Fehler
GLOBAL INT F_HGV_Err=496 ; Fehler
GLOBAL INT F_HGV_GeStr=497 ; Sammel Stoerung
;ENDFOLD (Fehler-Flags)
; 
;FOLD Msg IDs
; 
DECL INT HGV_USER_MSG_1=1
DECL INT HGV_USER_MSG_2=2
DECL INT HGV_USER_MSG_3=3
DECL INT HGV_USER_MSG_4=4
DECL INT HGV_USER_MSG_5=5
DECL INT HGV_USER_MSG_6=6
DECL INT HGV_USER_MSG_7=7
DECL INT HGV_USER_MSG_8=8
DECL INT HGV_USER_MSG_9=9
DECL INT HGV_USER_MSG_10=10
DECL INT HGV_USER_MSG_11=11
DECL INT HGV_USER_MSG_12=12
DECL INT HGV_USER_MSG_13=13
DECL INT HGV_USER_MSG_14=14
DECL INT HGV_USER_MSG_15=15
DECL INT HGV_USER_MSG_16=16
DECL INT HGV_USER_MSG_RESULT=17
DECL INT HGV_USER_MSG_MEAS=18
DECL INT HGV_USER_MSG_START=19
DECL INT HGV_USER_MSG_UP=20
DECL INT HGV_USER_MSG_BKORR=21
DECL INT HGV_USER_MSG_TKORR=22
DECL INT HGV_USER_MSG_FRAME=23
DECL INT HGV_USER_ERR_ACK=27
DECL INT HGV_USER_ERR_SEQUENCE=28
DECL INT HGV_USER_ERR_STATUS=30
DECL INT HGV_USER_ERR_COM=31
DECL INT HGV_USER_ERR_TIMEOUT=32
DECL INT HGV_USER_MSG_TCALIB=33
DECL INT HGV_USER_MSG_SPREP=34
; 
;Error IDs Tech_Vision
DECL INT HGV_USER_ERR=120
DECL INT HGV_USER_ERR_PROGID=124
DECL INT HGV_USER_ERR_TOL=125
DECL INT HGV_USER_ERR_PAR=926
DECL INT HGV_USER_ERR_FRAME=401
DECL INT HGV_USER_ERR_FRAM1=403
DECL INT HGV_USER_ERR_TOOL=402
DECL INT HGV_USER_ERR_MEASURE=220
DECL INT HGV_USER_ERR_CHECK_ART=221
DECL INT HGV_USER_ERR_CHECK_TCP=222
DECL INT HGV_USER_ERR_RESULT=223
DECL INT HGV_USER_ERR_START=224
DECL INT HGV_USER_ERR_TCALIB=225
; 
;ENDFOLD ( Msg IDs )
; 
;FOLD VF-Daten
; Frame definitionen
FRAME VF_HGV_Sen={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
GLOBAL FRAME AVF_HGV_Korr[20] ; Enthaelt VF Werte
AVF_HGV_Korr[1]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
AVF_HGV_Korr[2]={X 0.0140000,Y 0.224000,Z -0.0220000,A 0.0,B 0.0,C 0.0}
AVF_HGV_Korr[3]={X 0.238000,Y 0.248000,Z -0.0940000,A 0.00633239746,B -0.000614000,C 0.000915527344}
AVF_HGV_Korr[4]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
AVF_HGV_Korr[5]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
AVF_HGV_Korr[6]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
AVF_HGV_Korr[7]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
AVF_HGV_Korr[8]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
AVF_HGV_Korr[9]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
AVF_HGV_Korr[10]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
AVF_HGV_Korr[11]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
AVF_HGV_Korr[12]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
AVF_HGV_Korr[13]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
AVF_HGV_Korr[14]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
AVF_HGV_Korr[15]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
AVF_HGV_Korr[16]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
AVF_HGV_Korr[17]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
AVF_HGV_Korr[18]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
AVF_HGV_Korr[19]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
AVF_HGV_Korr[20]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
; Frame Grenzwerte
GLOBAL FRAME VF_HGV_Max={X 10.0000,Y 10.0000,Z 10.0000,A 5.00000,B 5.00000,C 5.00000}
GLOBAL FRAME VF_HGV_Min={X -10.0000,Y -10.0000,Z -10.0000,A -5.00000,B -5.00000,C -5.00000}
;ENDFOLD (VF-Daten)
; 
;FOLD DATA-Struktur
DECL INT NA_HGV_Data[17,6]
NA_HGV_Data[1,1]=6
NA_HGV_Data[1,2]=0
NA_HGV_Data[1,3]=3
NA_HGV_Data[1,4]=0
NA_HGV_Data[1,5]=1
NA_HGV_Data[1,6]=0
;ENDFOLD (Data-Struktur)
; 
;FOLD UP-Nummerzuweisung
DECL INT NA_HGV_UPNR[120,20] ; [Modellnr,Routinennr]
; 
;Modell 1
NA_HGV_UPNR[1,1]=10
NA_HGV_UPNR[1,2]=11
NA_HGV_UPNR[1,3]=12
NA_HGV_UPNR[1,4]=13
NA_HGV_UPNR[1,5]=14
NA_HGV_UPNR[1,6]=15
NA_HGV_UPNR[1,7]=16
NA_HGV_UPNR[1,8]=17
NA_HGV_UPNR[1,9]=18
NA_HGV_UPNR[1,10]=19
; 
;Modell 2
NA_HGV_UPNR[2,1]=20
NA_HGV_UPNR[2,2]=21
NA_HGV_UPNR[2,3]=22
NA_HGV_UPNR[2,4]=23
NA_HGV_UPNR[2,5]=24
NA_HGV_UPNR[2,6]=25
NA_HGV_UPNR[2,7]=26
NA_HGV_UPNR[2,8]=27
NA_HGV_UPNR[2,9]=28
NA_HGV_UPNR[2,10]=29
; 
;Modell 3
NA_HGV_UPNR[3,1]=30
NA_HGV_UPNR[3,2]=31
NA_HGV_UPNR[3,3]=32
NA_HGV_UPNR[3,4]=33
NA_HGV_UPNR[3,5]=34
NA_HGV_UPNR[3,6]=35
NA_HGV_UPNR[3,7]=36
NA_HGV_UPNR[3,8]=37
NA_HGV_UPNR[3,9]=38
NA_HGV_UPNR[3,10]=39
; 
;Modell 4
NA_HGV_UPNR[4,1]=40
NA_HGV_UPNR[4,2]=41
NA_HGV_UPNR[4,3]=42
NA_HGV_UPNR[4,4]=43
NA_HGV_UPNR[4,5]=44
NA_HGV_UPNR[4,6]=45
NA_HGV_UPNR[4,7]=46
NA_HGV_UPNR[4,8]=47
NA_HGV_UPNR[4,9]=48
NA_HGV_UPNR[4,10]=49
; 
;Modell 5
NA_HGV_UPNR[5,1]=50
NA_HGV_UPNR[5,2]=51
NA_HGV_UPNR[5,3]=52
NA_HGV_UPNR[5,4]=53
NA_HGV_UPNR[5,5]=54
NA_HGV_UPNR[5,6]=55
NA_HGV_UPNR[5,7]=56
NA_HGV_UPNR[5,8]=57
NA_HGV_UPNR[5,9]=58
NA_HGV_UPNR[5,10]=59
; 
;Modell 6
NA_HGV_UPNR[6,1]=60
NA_HGV_UPNR[6,2]=61
NA_HGV_UPNR[6,3]=62
NA_HGV_UPNR[6,4]=63
NA_HGV_UPNR[6,5]=64
NA_HGV_UPNR[6,6]=65
NA_HGV_UPNR[6,7]=66
NA_HGV_UPNR[6,8]=67
NA_HGV_UPNR[6,9]=68
NA_HGV_UPNR[6,10]=69
; 
;Modell 7
NA_HGV_UPNR[7,1]=70
NA_HGV_UPNR[7,2]=71
NA_HGV_UPNR[7,3]=72
NA_HGV_UPNR[7,4]=73
NA_HGV_UPNR[7,5]=74
NA_HGV_UPNR[7,6]=75
NA_HGV_UPNR[7,7]=76
NA_HGV_UPNR[7,8]=77
NA_HGV_UPNR[7,9]=78
NA_HGV_UPNR[7,10]=79
; 
;Modell 8
NA_HGV_UPNR[8,1]=80
NA_HGV_UPNR[8,2]=81
NA_HGV_UPNR[8,3]=82
NA_HGV_UPNR[8,4]=83
NA_HGV_UPNR[8,5]=84
NA_HGV_UPNR[8,6]=85
NA_HGV_UPNR[8,7]=86
NA_HGV_UPNR[8,8]=87
NA_HGV_UPNR[8,9]=88
NA_HGV_UPNR[8,10]=89
; 
;Modell 9
NA_HGV_UPNR[9,1]=90
NA_HGV_UPNR[9,2]=91
NA_HGV_UPNR[9,3]=92
NA_HGV_UPNR[9,4]=93
NA_HGV_UPNR[9,5]=94
NA_HGV_UPNR[9,6]=95
NA_HGV_UPNR[9,7]=96
NA_HGV_UPNR[9,8]=97
NA_HGV_UPNR[9,9]=98
NA_HGV_UPNR[9,10]=99
; 
;Kalib 
NA_HGV_UPNR[100,1]=101
NA_HGV_UPNR[100,2]=102
NA_HGV_UPNR[100,3]=103
NA_HGV_UPNR[100,4]=104
NA_HGV_UPNR[100,5]=105
NA_HGV_UPNR[100,6]=106
NA_HGV_UPNR[100,7]=107
NA_HGV_UPNR[100,8]=108
NA_HGV_UPNR[100,9]=109
NA_HGV_UPNR[100,10]=110
NA_HGV_UPNR[100,11]=111
NA_HGV_UPNR[100,12]=112
NA_HGV_UPNR[100,13]=113
NA_HGV_UPNR[100,14]=114
NA_HGV_UPNR[100,15]=115
NA_HGV_UPNR[100,16]=116
NA_HGV_UPNR[100,17]=117
NA_HGV_UPNR[100,18]=119
NA_HGV_UPNR[100,19]=119
NA_HGV_UPNR[100,20]=100
; 
;ENDFOLD (UP-Nummerzuweisung)
; 
ENDDAT
